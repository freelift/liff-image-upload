<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÅ‡∏ä‡∏ó</title>
</head>
<body>
  <h2>üì§ ‡∏™‡πà‡∏á‡∏™‡∏•‡∏¥‡∏õ‡πÄ‡∏Ç‡πâ‡∏≤‡πÅ‡∏ä‡∏ó LINE</h2>

  <!-- ‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏†‡∏≤‡∏û‡πÄ‡∏≠‡∏á -->
  <button id="openGalleryBtn">üì∏ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏à‡∏≤‡∏Å‡πÅ‡∏Å‡∏•‡πÄ‡∏•‡∏≠‡∏£‡∏µ‡πà</button><br><br>

  <!-- input ‡πÅ‡∏ö‡∏ö‡∏ã‡πà‡∏≠‡∏ô -->
  <input type="file" id="imageInput" accept="image/*" style="display: none;" />
  <img id="preview" width="200" />

  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <script>
    async function main() {
      await liff.init({ liffId: "2007890470-ryZVnqlX" }); // << ‡πÉ‡∏™‡πà LIFF ID ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì

      const imageInput = document.getElementById('imageInput');
      const preview = document.getElementById('preview');
      const openGalleryBtn = document.getElementById('openGalleryBtn');

      // ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏Å‡∏•‡πÄ‡∏•‡∏≠‡∏£‡∏µ‡πà
      openGalleryBtn.onclick = () => {
        imageInput.click();
      };

      // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÅ‡∏•‡πâ‡∏ß‡∏™‡πà‡∏á Flex Message ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
      imageInput.addEventListener('change', async function () {
        const file = imageInput.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = async function (e) {
          const base64 = e.target.result;

          preview.src = base64;

          const flexMessage = {
            type: "flex",
            altText: "‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏™‡πà‡∏á‡∏™‡∏•‡∏¥‡∏õ‡πÅ‡∏•‡πâ‡∏ß",
            contents: {
              type: "bubble",
              hero: {
                type: "image",
                url: base64,
                size: "full",
                aspectRatio: "1:1",
                aspectMode: "cover"
              },
              body: {
                type: "box",
                layout: "vertical",
                contents: [
                  {
                    type: "text",
                    text: "üì§ ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏™‡πà‡∏á‡∏™‡∏•‡∏¥‡∏õ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß",
                    weight: "bold",
                    size: "md",
                    wrap: true
                  },
                  {
                    type: "text",
                    text: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö",
                    size: "sm",
                    color: "#666666",
                    wrap: true,
                    margin: "md"
                  }
                ]
              }
            }
          };

          await liff.sendMessages([flexMessage]);
          alert("‚úÖ ‡∏™‡πà‡∏á Flex Message ‡πÅ‡∏•‡πâ‡∏ß");
          liff.closeWindow();
        };
        reader.readAsDataURL(file);
      });
    }

    main();
  </script>
</body>
</html>
