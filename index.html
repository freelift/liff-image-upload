<input type="file" id="imageInput" accept="image/*" style="display: none;" />
<img id="preview" width="200" />

<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
<script>
  async function main() {
    await liff.init({ liffId: "2007890470-ryZVnqlX" }); // แทนที่ด้วย LIFF ID ของคุณ

    const imageInput = document.getElementById('imageInput');
    const preview = document.getElementById('preview');

    // เปิดแกลเลอรี่ทันทีเมื่อโหลดหน้า
    window.onload = () => {
      imageInput.click();
    };

    // ส่งภาพเข้าแชททันทีเมื่อเลือกรูป
    imageInput.addEventListener('change', async function () {
      const file = imageInput.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = async function (e) {
        const base64 = e.target.result;

        preview.src = base64;

        // ส่งรูปกลับเข้าแชท LINE
        await liff.sendMessages([
          {
            type: "image",
            originalContentUrl: base64,
            previewImageUrl: base64
          }
        ]);

        alert("✅ ส่งภาพเรียบร้อยแล้ว");
        liff.closeWindow();
      };
      reader.readAsDataURL(file);
    });
  }

  main();
</script>

